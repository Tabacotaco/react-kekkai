!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=31)}([function(e,t){e.exports=require("react")},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n.apply(this,arguments)}e.exports=n},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t,n){var r=n(15),o=n(2);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?o(e):t}},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t,n){var r=n(23);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t,n){var r=n(1);e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){r(e,t,n[t])})}return e}},function(e,t,n){e.exports=n(21)},function(e,t){function n(e,t,n,r,o,i,a){try{var l=e[i](a),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(r,o)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise(function(o,i){var a=e.apply(t,r);function l(e){n(a,o,i,l,s,"next",e)}function s(e){n(a,o,i,l,s,"throw",e)}l(void 0)})}}},function(e,t,n){var r=n(18),o=n(19),i=n(20);e.exports=function(e){return r(e)||o(e)||i()}},function(e,t){e.exports=function(e){if(null==e)throw new TypeError("Cannot destructure undefined")}},function(e,t,n){(function(e){function n(e,t){for(var n=0,r=e.length-1;r>=0;r--){var o=e[r];"."===o?e.splice(r,1):".."===o?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(e){return r.exec(e).slice(1)};function i(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}t.resolve=function(){for(var t="",r=!1,o=arguments.length-1;o>=-1&&!r;o--){var a=o>=0?arguments[o]:e.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(t=a+"/"+t,r="/"===a.charAt(0))}return(r?"/":"")+(t=n(i(t.split("/"),function(e){return!!e}),!r).join("/"))||"."},t.normalize=function(e){var r=t.isAbsolute(e),o="/"===a(e,-1);return(e=n(i(e.split("/"),function(e){return!!e}),!r).join("/"))||r||(e="."),e&&o&&(e+="/"),(r?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(i(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,n){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var o=r(e.split("/")),i=r(n.split("/")),a=Math.min(o.length,i.length),l=a,s=0;s<a;s++)if(o[s]!==i[s]){l=s;break}var c=[];for(s=l;s<o.length;s++)c.push("..");return(c=c.concat(i.slice(l))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){var t=o(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},t.basename=function(e,t){var n=o(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){return o(e)[3]};var a="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,n(17))},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(t){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=r=function(e){return n(e)}:e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},r(t)}e.exports=r},function(e,t){e.exports=require("moment")},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function l(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var s,c=[],u=!1,d=-1;function f(){u&&s&&(u=!1,s.length?c=s.concat(c):d=-1,c.length&&h())}function h(){if(!u){var e=l(f);u=!0;for(var t=c.length;t;){for(s=c,c=[];++d<t;)s&&s[d].run();d=-1,t=c.length}s=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function v(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||u||l(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t){e.exports=function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}},function(e,t){e.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(e,t,n){var r=function(){return this||"object"==typeof self&&self}()||Function("return this")(),o=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,i=o&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,e.exports=n(22),o)r.regeneratorRuntime=i;else try{delete r.regeneratorRuntime}catch(e){r.regeneratorRuntime=void 0}},function(e,t){!function(t){"use strict";var n,r=Object.prototype,o=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag",c="object"==typeof e,u=t.regeneratorRuntime;if(u)c&&(e.exports=u);else{(u=t.regeneratorRuntime=c?e.exports:{}).wrap=b;var d="suspendedStart",f="suspendedYield",h="executing",p="completed",v={},m={};m[a]=function(){return this};var g=Object.getPrototypeOf,y=g&&g(g(M([])));y&&y!==r&&o.call(y,a)&&(m=y);var k=C.prototype=w.prototype=Object.create(m);S.prototype=k.constructor=C,C.constructor=S,C[s]=S.displayName="GeneratorFunction",u.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===S||"GeneratorFunction"===(t.displayName||t.name))},u.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(k),e},u.awrap=function(e){return{__await:e}},O(N.prototype),N.prototype[l]=function(){return this},u.AsyncIterator=N,u.async=function(e,t,n,r){var o=new N(b(e,t,n,r));return u.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},O(k),k[s]="Generator",k[a]=function(){return this},k.toString=function(){return"[object Generator]"},u.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},u.values=M,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,o){return l.type="throw",l.arg=e,t.next=r,o&&(t.method="next",t.arg=n),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=o.call(a,"catchLoc"),c=o.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:M(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),v}}}function b(e,t,n,r){var o=t&&t.prototype instanceof w?t:w,i=Object.create(o.prototype),a=new R(r||[]);return i._invoke=function(e,t,n){var r=d;return function(o,i){if(r===h)throw new Error("Generator is already running");if(r===p){if("throw"===o)throw i;return A()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var l=x(a,n);if(l){if(l===v)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===d)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var s=E(e,t,n);if("normal"===s.type){if(r=n.done?p:f,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r=p,n.method="throw",n.arg=s.arg)}}}(e,n,a),i}function E(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function w(){}function S(){}function C(){}function O(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function N(e){var t;this._invoke=function(n,r){function i(){return new Promise(function(t,i){!function t(n,r,i,a){var l=E(e[n],e,r);if("throw"!==l.type){var s=l.arg,c=s.value;return c&&"object"==typeof c&&o.call(c,"__await")?Promise.resolve(c.__await).then(function(e){t("next",e,i,a)},function(e){t("throw",e,i,a)}):Promise.resolve(c).then(function(e){s.value=e,i(s)},function(e){return t("throw",e,i,a)})}a(l.arg)}(n,r,t,i)})}return t=t?t.then(i,i):i()}}function x(e,t){var r=e.iterator[t.method];if(r===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,x(e,t),"throw"===t.method))return v;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var o=E(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,v;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,v):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function M(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(o.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return i.next=i}}return{next:A}}function A(){return{value:n,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(14),o=n.n(r),i=n(3),a=n.n(i),l=n(12),s=n.n(l),c=n(9),u=n.n(c),d=n(10),f=n.n(d),h=n(11),p=n.n(h),v=n(4),m=n.n(v),g=n(5),y=n.n(g),k=n(6),b=n.n(k),E=n(7),w=n.n(E),S=n(2),C=n.n(S),O=n(8),N=n.n(O),x=n(1),L=n.n(x),T=n(0),R=n.n(T),M=n(15),A=n.n(M),P=n(16),D=n.n(P),$=120;function _(){for(var e=[],t=0;t<36;t++)e[t]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]="0123456789abcdef".substr(3&e[19]|8,1),e[8]="-",e[13]="-",e[18]="-",e[23]="-",e.join("")}function I(e){return(Array.isArray(e)?e:[e]).filter(function(e){return e})}function F(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(e&&null!==e)switch(A()(e)){case"boolean":return!1;case"number":return isNaN(e)&&0!==e;case"string":return 0===e.trim().length;default:if(D.a.isDate(e))return!D()(e).isValid()}return!0}function z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.def,n=void 0===t?null:t,r=e.sm,o=void 0===r?null:r,i=e.md,a=void 0===i?null:i,l=e.lg,s=void 0===l?null:l,c=e.xl,u={sm:o,md:a,lg:s,xl:void 0===c?null:c},d=["col",null===n?"col-12":!1===n||"number"!=typeof n||isNaN(n)?"col-none":"col-".concat(n)];return Object.keys(u).filter(function(e){return null!==u[e]&&(!1===u[e]||"number"==typeof u[e]&&!isNaN(u[e]))}).forEach(function(e){return d.push(!1===u[e]?"col-".concat(e,"-none"):"col-".concat(e,"-").concat(u[e]))}),d.join(" ")}function j(e,t){var n=Symbol("TRANS");return e[n]=e[t],delete e[t],n}function G(e,t){return t||e.$fieldOpts.filter(function(e){var t=e.type;return re===t}).map(function(e){var t=e.key,n=e.props,r=n.name,o=void 0===r?t:r,i=n.label,a=n.card,l=void 0===a?{def:12}:a,s=n.sortable,c=void 0!==s&&s;return{name:o,label:i,width:z(l),sortable:c}})}function B(e,t){var n=e.$dataviewOpts.props.reorderable,r=void 0!==n&&n;return t||e.$fieldOpts.filter(function(e){var t=e.type;return re===t}).sort(function(e,t){var n=e.locked,r=void 0!==n&&n,o=t.locked;return r===(void 0!==o&&o)?0:!0===r?-1:1}).map(function(e,t){var n=e.key,o=e.props,i=o.name,a=void 0===i?n:i,l=o.label,s=o.list,c=void 0===s?$:s,u=o.filter,d=void 0===u?null:u,f=o.locked,h=void 0!==f&&f,p=o.hidden,v=void 0!==p&&p,m=o.resizable,g=void 0!==m&&m,y=o.lockable,k=void 0!==y&&y,b=o.hideable,E=void 0===b||b,w=o.sortable,S=void 0!==w&&w;return{name:a,label:l,width:c,locked:h,seq:t,hidden:v,filterUID:null===d?null:_(),filter:d,resizable:g,lockable:k,reorderable:r,hideable:E&&"string"==typeof l,sortable:S}})}function q(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;t.classList[e?"add":"remove"]("active"),n.classList[e?"add":"remove"]("active")}function U(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;arguments.length>3&&arguments[3];t.classList[e?"add":"remove"]("hover"),n.classList[e?"add":"remove"]("hover")}var W={List:_(),Form:_(),Card:_()},H=(n(24),{defaultClassName:Symbol("DEFAULT_CLASS_NAME"),listClassName:Symbol("CELL_CLASS_NAME"),groupClassName:Symbol("GROUP_CLASS_NAME"),getGridClassName:Symbol("GRID_CLASS_NAME"),gridLabelCSS:Symbol("GRID_LABEL_CSS"),validCells:Symbol("VALID_CELLS"),getCell:Symbol("GET_CELL"),isDisplay:Symbol("IS_DISPLAY"),onHover:Symbol("ON_HOVER")});function V(e){return R.a.createElement("div",{className:"kekkai-display"},e.children)}function K(e){var t=e.dataModel,n=e.name,r=e.children,o=void 0===r?[]:r,i=e.onChange,l=void 0===i?function(){}:i;return R.a.createElement("div",{className:"kekkai-editor"},I(o).map(function(e){return R.a.createElement(e.type,a()({key:"editor"},u()({},e.props,{value:t[n],onChange:function(e){t[n]=e.target.value,l(n,t[n],t)}})))}))}var J=H.defaultClassName,Y=H.listClassName,X=H.groupClassName,Z=H.validCells,Q=H.isDisplay,ee=H.getCell,te=H.getGridClassName,ne=H.onHover,re=function(e){function t(){var e,n;m()(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=b()(this,(e=w()(t)).call.apply(e,[this].concat(o))),L()(C()(n),ne,function(){var e=n.props,t=e.name,r=e.dataModel.$getValid(t);n.$container&&!0!==r&&n.$container.setAlert(r,{type:"warning",icon:"fa fa-exclamation-triangle"})}),n}return N()(t,e),y()(t,[{key:ee,value:function(e,t){var n=e.filter(function(e){return e.type===t});return 0===n.length?null:n}},{key:te,value:function(e){var t=this.props[e];return[].concat(s()(this[H.defaultClassName]),[z(t)]).join(" ")}},{key:"render",value:function(){var e=this[H.validCells],t=this[H.getCell](e,V),n=this[H.getCell](e,K),r=this.props,o=r.label,i=r.name,l=r.dataModel;switch(this.$dataview.panel){case W.List:return R.a.createElement("td",{className:this[H.listClassName],onMouseOver:this[H.onHover]},this[H.isDisplay]?t.map(function(e){return R.a.createElement(e.type,a()({key:"display"},e.props))}):n.map(function(e){return R.a.createElement(e.type,a()({key:"editor"},e.props,{dataModel:l,name:i}))}));default:return R.a.createElement("div",{className:this[H.getGridClassName]("form")},R.a.createElement("div",{className:this[H.groupClassName],onMouseOver:this[H.onHover]},R.a.createElement("label",null,o),this[H.isDisplay]?t.map(function(e){return R.a.createElement(e.type,a()({key:"display"},e.props))}):n.map(function(e){return R.a.createElement(e.type,a()({key:"editor"},e.props,{dataModel:l,name:i}))})))}}},{key:"$owner",get:function(){return this.props.owner}},{key:"$container",get:function(){return this.props.container}},{key:"$dataview",get:function(){return this.props.dataview}},{key:J,get:function(){var e=this.props,t=e.name,n=e.dataModel,r=e.overflow,o=void 0===r||r,i=e.align,a=void 0===i?"left":i,l=n.$getValid(t);return["kekkai-field","text-".concat(a),!1===o&&W.List!==this.$dataview.panel?"":"text-overflow",!0===l?"":"invalid"].filter(function(e){return"string"==typeof e&&e.trim().length>0})}},{key:Y,get:function(){return s()(this[H.defaultClassName]).join(" ")}},{key:X,get:function(){var e=this.$dataview.labelSize,t=["form-group"];return W.Form===this.$dataview.panel&&"number"==typeof e&&!isNaN(e)&&e>0&&e<13&&(t.push("horizontal"),t.push("horizontal-".concat(e))),t.join(" ")}},{key:Z,get:function(){var e=this.props,t=e.name,n=e.dataModel,r=e.children,o=I(void 0===r?[]:r).filter(function(e){return null!==e&&[V,K].indexOf(e.type)>=0});return o.findIndex(function(e){return e.type===V})<0&&o.push(R.a.createElement(V,null,n[t])),o}},{key:Q,get:function(){var e=this.props,t=e.name,n=e.dataModel,r=this[H.getCell](this[H.validCells],K);return!n.$editable||null===r||r.filter(function(e){var r=e.props.editable,o=void 0===r?function(){return!0}:r;return o instanceof Function?o(n[t],n):!0===o}).length!==r.length}}],[{key:"isEditable",value:function(e){var t,n,r=e.props,o=r.name,i=r.dataModel,a=r.children,l=I(void 0===a?[]:a).filter(function(e){return null!==e&&K===e.type});return 0!==l.length&&!0===(t=l[0].props.editable,(n=void 0===t?function(){return!0}:t)instanceof Function?n(i[o],i):!0===n)}},{key:"isValid",value:function(e){var t,n,r,o,i,a=e.props,l=a.name,s=a.dataModel,c=a.children,u=I(void 0===c?[]:c).filter(function(e){return null!==e&&K===e.type});return 0===u.length||!0===(t=u[0].props,n=t.required,r=void 0!==n&&n,o=t.validation,i=void 0===o?function(){return!0}:o,(!r||!F(s[l]))&&i(s[l],s))}},{key:"getSortable",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).sortable,t=void 0!==e&&e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.seq,o=n.dir,i=void 0===o?"asc":o,a="boolean"==typeof t?{}:t,l=a.seq,s=a.dir;return"boolean"==typeof t?t:{seq:"number"!=typeof l||isNaN(l)&&0!==l?r:l,dir:"string"==typeof s&&["asc","desc"].indexOf(s.toLowerCase())?s.toLowerCase():i}}}]),t}(T.Component),oe=n(13),ie=n.n(oe);function ae(e){var t=e.icon,n=e.disabled,r=void 0!==n&&n,o=e.children,i=void 0===o?[]:o,a=e.onClick,l=void 0===a?function(){}:a;return R.a.createElement("a",{className:"kekkai-nav-btn",disabled:r,onClick:r?null:l},"string"!=typeof t?null:R.a.createElement("i",{className:t}),I(i))}function le(e){var t=e.children;return R.a.createElement("li",null,R.a.createElement("a",null,t))}function se(e){return R.a.createElement("li",null,R.a.createElement(ae,e))}function ce(e){return R.a.createElement("li",null,R.a.createElement("input",e))}function ue(e){var t=e.color;return R.a.createElement("li",{className:"divider",style:{backgroundColor:t}})}function de(e){var t=e.className,n=void 0===t?"":t,r=e.align,o=void 0===r?"left":r,i=e.children,a=void 0===i?[]:i;return R.a.createElement("ul",{className:["nav",n,"left"!==o?o:""].join(" ")},I(a).filter(function(e){var t=e.type;return[se,ce,le,fe].indexOf(t)>=0}))}var fe=function(e){function t(){var e,n;m()(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=b()(this,(e=w()(t)).call.apply(e,[this].concat(o))),L()(C()(n),"state",{show:!1}),L()(C()(n),"onTrigger",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};n.setState({show:!0==!n.state.show},function(){var t=n.props,r=t.onOpen,o=void 0===r?function(){}:r,i=t.onClose,a=void 0===i?function(){}:i,l=n.state.show;void 0!==l&&l?o():a(),e()})}),L()(C()(n),"onClickOutside",function(e){var t=n.state.show,r=n.refs.menu;t&&!r.contains(e.target)&&(e.preventDefault(),e.stopPropagation(),n.onTrigger())}),n}return N()(t,e),y()(t,[{key:"componentDidMount",value:function(){t.Body.addEventListener("click",this.onClickOutside)}},{key:"componentWillUnmount",value:function(){t.Body.removeEventListener("click",this.onClickOutside)}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.tag,o=void 0===r?"div":r,i=n.display,l=n.bgColor,s=n.txColor,c=n.children,d=void 0===c?[]:c,f=this.state.show;return R.a.createElement(o,(e={},L()(e,"data-tag",o),L()(e,"className","kekkai-dropdown"),L()(e,"ref","dropdown"),e),[R.a.createElement(ae,{key:"displayBtn",onClick:function(){return t.onTrigger()}},i),R.a.createElement("ul",{key:"menu",ref:"menu",className:"menu",style:u()({display:f?"block":"none",backgroundColor:l,color:s},this.positionCSS)},I(d).filter(function(e){var t=e.type;return[se,ue].indexOf(t)>=0}).map(function(e){return ue===e.type?e:R.a.createElement(se,a()({key:e.key},e.props,{onClick:function(){return t.onTrigger(e.props.onClick)}}))}))])}},{key:"positionCSS",get:function(){var e=this.props,n=e.tag,r=void 0===n?"div":n,o=e.align,i=void 0===o?"left":o;if("div"!==r)return{position:"absolute"};var a="dropdown"in this.refs?this.refs.dropdown.getBoundingClientRect():{},l=a.width,s=void 0===l?0:l,c=a.height,u=void 0===c?0:c,d=a.top,f=void 0===d?0:d,h=a.left,p=void 0===h?0:h,v=(a.right,t.Body.clientWidth);return"left"===i?{top:f+u,left:p,right:"auto"}:{top:f+u,left:"auto",right:v-p-s}}}]),t}(T.Component);L()(fe,"Body",document.body);var he=function(e){function t(){return m()(this,t),b()(this,w()(t).apply(this,arguments))}return N()(t,e),y()(t,[{key:"render",value:function(){var e=this.props,t=e.className,n=void 0===t?"":t,r=e.children,o=void 0===r?[]:r,i=e.style,a=void 0===i?{}:i;return R.a.createElement("nav",{className:["kekkai-navbar",n].join(" "),style:a},I(o).filter(function(e){return de===e.type}))}}]),t}(T.Component),pe={tgToolbar:Symbol("TG_TOOLBAR"),tgSelection:Symbol("TG_SELECTION"),tgRowMenu:Symbol("TG_ROW_MENU"),tgRowDbclick:Symbol("TG_ROW_DBCLICK"),emNone:Symbol("EM_NONE"),emInline:Symbol("EM_INLINE"),emPopup:Symbol("EM_POPUP"),ref:Symbol("REF"),uuid:Symbol("UUID"),container:Symbol("CONTAINER"),showMessage:Symbol("SHOW_MESSAGE"),options:Symbol("OPTIONS"),todos:Symbol("TODOS"),getTargetData:Symbol("GET_TARGET_DATA")},ve=function(){function e(){m()(this,e)}return y()(e,[{key:"TOOLBAR",get:function(){return pe.tgToolbar}},{key:"SELECTION",get:function(){return pe.tgSelection}},{key:"ROW_MENU",get:function(){return pe.tgRowMenu}},{key:"ROW_DBCLICK",get:function(){return pe.tgRowDbclick}}]),e}(),me=function(){function e(){m()(this,e)}return y()(e,[{key:"NONE",get:function(){return pe.emNone}},{key:"INLINE",get:function(){return pe.emInline}},{key:"POPUP",get:function(){return pe.emPopup}}]),e}(),ge=new ve,ye=new me,ke=pe.uuid,be=pe.ref,Ee=pe.container,we=pe.options,Se=pe.showMessage,Ce=function(){function e(t){var n=t.ref,r=t.concat,o=t.text,i=t.icon,a=t.trigger,l=void 0===a?ge.TOOLBAR:a,s=t.editingMode,c=void 0===s?ye.NONE:s,u=t.executable,d=void 0===u?function(){return!0}:u,f=t.execute,h=void 0===f?function(){}:f,p=t.onSuccess,v=void 0===p?function(){}:p,g=t.confirmMsg,y=void 0===g?{type:"",icon:"",title:"",content:""}:g,k=t.responseMsg,b=void 0===k?{type:"",icon:"",title:"",content:""}:k;if(m()(this,e),L()(this,ke,_()),L()(this,be,null),L()(this,Ee,null),L()(this,we,{}),"string"!=typeof n||0===n.trim().length)throw new Error("KekkaiTodo'ref is required.");this[pe.ref]=n,this[pe.options]={concat:r,text:o,icon:i,trigger:l,editingMode:c,executable:d,confirmMsg:y,execute:h,onSuccess:v,responseMsg:b}}return y()(e,[{key:"isExecutable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,n=void 0===t?null:t,r=e.list,o=void 0===r?[]:r,i=this[pe.container];return!0===(0,this[pe.options].executable)({data:n,list:o},i)}},{key:"execute",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,n=void 0===t?null:t,r=e.list,o=void 0===r?[]:r,i=this[pe.container],a=this[pe.options].execute,l=this[pe.showMessage]("confirmMsg"),s=l.show,c=l.type,u=l.icon,d=l.title,f=l.content;this.isExecutable({data:n,list:o})&&(s?i.setConfirm(f,{type:c,icon:u,title:d,callbackFn:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?a({data:n,list:o},i):(i.data.forEach(function(e){return e.$undo(!1)}),i.forceUpdate())}}):a({data:n,list:o},i))}},{key:"onResponse",value:function(e){var t=e.success,n=void 0!==t&&t,r=e.msg,o=void 0===r?"":r,i=this[pe.container];try{var a=this[pe.options].onSuccess,l=void 0===a?function(){}:a,s=this[pe.showMessage]("responseMsg"),c=s.show,u=s.type,d=s.icon,f=s.title,h=s.content;if(!n)throw new Error(o);i.setState({executing:{todo:null,data:null},alert:{show:c,type:u,icon:d,title:f,content:h}},function(){l({success:n,msg:o},i)})}catch(e){console.error(e),i.setAlert("系統發生預期外之錯誤.",{type:"danger",icon:"fa fa-exclamation-circle",title:"System Error"})}}},{key:Se,value:function(e){var t=this[pe.options][e],n=t.type,r=void 0===n?"":n,o=t.icon,i=void 0===o?"":o,a=t.title,l=void 0===a?"":a,s=t.content,c=void 0===s?"":s;return{show:"string"==typeof c&&c.trim().length>0,type:r,icon:i,title:l,content:c}}},{key:"container",set:function(e){this[pe.container]=e}},{key:"uuid",get:function(){return this[pe.uuid]}},{key:"ref",get:function(){return this[pe.ref]}},{key:"concat",get:function(){return this[pe.options].concat||null}},{key:"text",get:function(){return this[pe.options].text}},{key:"icon",get:function(){return this[pe.options].icon}},{key:"trigger",get:function(){return this[pe.options].trigger}},{key:"editingMode",get:function(){return this[pe.options].editingMode}}]),e}(),Oe=pe.container,Ne=pe.todos,xe=pe.getTargetData,Le=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(m()(this,e),L()(this,Oe,null),L()(this,Ne,[]),n.filter(function(e){return ge.ROW_DBCLICK===e.trigger}).length>1)throw new Error("Only could set 1 Trigger(ROW_DBCLICK).");this[pe.container]=t,this[pe.todos]=n.map(function(e){return e.container=t,e})}return y()(e,[{key:"getAllowedTodos",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.strict,r=void 0===n||n,o=t.targetData,i=void 0===o?null:o,a=this[pe.container],l=a.selecteds.length>0,s=a.editings.length>0,c=this[pe.getTargetData](e,{strict:r,targetData:i}),u=c.data,d=c.list;switch(a.panel){case W.Form:return ge.TOOLBAR!==e?[]:this.todos.filter(function(e){return!s&&!0===e.isExecutable([ge.TOOLBAR,ge.SELECTION].indexOf(e.trigger)>=0?{data:null,list:d}:{data:u,list:[]})});case W.List:return this.todos.filter(function(t){return e===t.trigger}).filter(function(e){switch(e.trigger){case ge.TOOLBAR:return!l&&!0===e.isExecutable({data:u,list:d});case ge.SELECTION:return(!r||l)&&!0===e.isExecutable({data:u,list:d});default:return!l&&!s&&(r?!0===e.isExecutable({data:u,list:d}):d.filter(function(t){return!0===e.isExecutable({data:t,list:[]})}).length>0)}});case W.Card:return[ge.SELECTION,ge.ROW_DBCLICK].indexOf(e)>=0?[]:this.todos.filter(function(t){return e===([ge.SELECTION,ge.ROW_DBCLICK].indexOf(t.trigger)>=0?ge.ROW_MENU:t.trigger)}).filter(function(e){switch(e.trigger){case ge.TOOLBAR:return!0===e.isExecutable({data:u,list:d});case ge.SELECTION:return!s&&!0===e.isExecutable({data:null,list:d});default:return!s&&!0===e.isExecutable({data:u,list:[]})}});default:return[]}}},{key:xe,value:function(e,t){var n=t.strict,r=void 0===n||n,o=t.targetData,i=void 0===o?null:o,a=this[pe.container],l=i||a.executingData;switch(a.panel){case W.Form:switch(e){case ge.TOOLBAR:case ge.SELECTION:return{data:l,list:a.data};default:return{data:l,list:[]}}case W.List:switch(e){case ge.TOOLBAR:return{data:null,list:a.data};case ge.SELECTION:return{data:null,list:r?a.selecteds:a.data};default:return r?{data:l,list:[]}:{data:null,list:a.data}}case W.Card:switch(e){case ge.TOOLBAR:return{data:null,list:a.data};default:return{data:l,list:[l]}}}}},{key:"container",get:function(){return this[pe.container]}},{key:"todos",get:function(){return this[pe.todos]}}]),e}(),Te=function(e){var t=e.concat,n=e.ref,r=e.text,o=e.icon,i=e.overrideParams,a=void 0===i?function(){return{}}:i,l=e.editingMode,s=void 0===l?ye.POPUP:l,c=e.executable,u=void 0===c?function(){return!0}:c,d=e.onSuccess,f=void 0===d?function(){}:d,h=e.responseMsg,p=void 0===h?{type:"success",icon:"fa fa-check-square-o",content:"資料已完成新增"}:h;if(ye.NONE===s)throw new Error("Todo(Create)'s editing mode must be INLINE / POPUP.");var v=new Ce({trigger:ge.TOOLBAR,concat:t,ref:n,text:r,icon:o,editingMode:s,executable:u,overrideParams:a,responseMsg:p,execute:function(e,t){ie()(e);var n=a(),r=new Be(t,n instanceof Be?n.$json:n,{editable:!0,isNew:!0,hidden:ye.POPUP===s});t.add(r,{callbackFn:function(){var e=ye.INLINE===s&&W.Form===t.panel;(ye.POPUP===s||e)&&t.setExecuting({data:r,todo:v,popup:!e},e?function(){t.data.filter(function(e){return e.$uid!==r.$uid&&e.$setHidden(!0)})}:null)}})},onSuccess:function(e,t){var n=t.pager.page,r=t.state.filters.filters,o=void 0===r?[]:r;t.doSearch(o,n),f(e)}});return v},Re=function(e){var t=e.trigger,n=void 0===t?ge.ROW_DBCLICK:t,r=e.concat,o=e.ref,i=e.text,a=e.icon,l=e.overrideParams,s=void 0===l?function(e){return e}:l,c=e.editingMode,u=void 0===c?ye.POPUP:c,d=e.executable,f=void 0===d?function(){return!0}:d,h=e.onSuccess,p=void 0===h?function(){}:h,v=e.responseMsg,m=void 0===v?{type:"success",icon:"fa fa-check-square-o",content:"資料已完成修改"}:v;if(ge.SELECTION===n)throw new Error('[BasicTodo.UPDATE] Trigger mustn\'t be "SELECTION".');if(ge.TOOLBAR===n&&ye.POPUP===u)throw new Error("[BasicTodo.UPDATE] Trigger(TOOLBAR) means multiple-edit, so can't set editing mode as POPUP.");var g=new Ce({trigger:n,concat:r,ref:o,text:i,icon:a,editingMode:u,responseMsg:m,executable:function(e,t){var r=e.data,o=(e.list,t.data.filter(function(e){return!e.$isNew}));return o.length>0&&0===o.filter(function(e){return!0===e.$editable}).length&&!0===f(ge.TOOLBAR===n?{list:o}:{data:r},t)},execute:function(e,t){var r=e.data,o=void 0===r?null:r,i=e.list,a=void 0===i?[]:i;t.edit(!0,{editData:ge.TOOLBAR===n?a.map(function(e){return s(e)}):[s(o)],callbackFn:function(){ge.TOOLBAR!==n&&t.setExecuting({todo:g,data:o,popup:!0})}})},onSuccess:function(e,t){var n=t.pager.page,r=t.state.filters.filters,o=void 0===r?[]:r;t.doSearch(o,n),p(e)}});return g},Me=function(e){var t=e.trigger,n=e.concat,r=e.ref,o=e.text,i=e.icon,a=e.overrideParams,l=void 0===a?function(e){return e}:a,s=e.executable,c=void 0===s?function(){return!0}:s,u=e.onSuccess,d=void 0===u?function(){}:u,f=e.confirmMsg,h=void 0===f?{type:"info",icon:"fa fa-question-circle",title:"資料即將被刪除",content:"確定刪除所選取之資料 ?"}:f,p=e.responseMsg,v=void 0===p?{type:"success",icon:"fa fa-check-square-o",content:"資料已完成刪除"}:p;if(ge.TOOLBAR===t)throw new Error("[BasicTodo.DELETE] Trigger(TOOLBAR) can't remove data.");var m=new Ce({trigger:t,concat:n,ref:r,text:o,icon:i,confirmMsg:h,responseMsg:v,executable:function(e){var n=e.list,r=e.data;return I(ge.SELECTION===t?n:r).length>0&&!0===c({list:n,data:r})},execute:function(e,n){var r=e.list,o=e.data;n.setExecuting({todo:m,data:ge.SELECTION===t?r.map(function(e){return l(e)}):l(o)},function(){return n.doCommit()})},onSuccess:function(e,t){t.setExecuting({todo:null,data:null},function(){var n=t.pager.page,r=t.state.filters.filters,o=void 0===r?[]:r;t.doSearch(o,n),d(e)})}});return m},Ae=new(function(){function e(){m()(this,e)}return y()(e,[{key:"CREATE",get:function(){return Te}},{key:"UPDATE",get:function(){return Re}},{key:"DELETE",get:function(){return Me}}]),e}()),Pe={container:Symbol("CONTAINER"),dataview:Symbol("DATAVIEW"),viewopts:Symbol("VIEW_OPTIONS"),status:Symbol("STATUS"),values:Symbol("VALUES"),inits:Symbol("INITS"),uid:Symbol("UID"),refresh:Symbol("REFRESH")},De=Pe.container,$e=Pe.dataview,_e=Pe.viewopts,Ie=Pe.uid,Fe=Pe.values,ze=Pe.inits,je=Pe.status,Ge=Pe.refresh,Be=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{checked:!1,editable:!1,isNew:!1,hidden:!1};m()(this,e),L()(this,De,null),L()(this,$e,null),L()(this,_e,{}),L()(this,Ie,_()),L()(this,Fe,{}),L()(this,ze,"{}"),L()(this,je,{checked:!1,editable:!1,isNew:!1});var i=o.checked,a=void 0!==i&&i,l=o.editable,s=void 0!==l&&l,c=o.isNew,u=void 0!==c&&c,d=o.hidden,f=void 0!==d&&d;this[Pe.status]={checked:a,editable:s,isNew:u,hidden:f},this[Pe.inits]=JSON.stringify(r),this[Pe.values]=JSON.parse(this[Pe.inits]),Object.keys(this[Pe.values]).forEach(function(e){return Object.defineProperty(n,e,{get:function(){return this[Pe.values][e]},set:function(t){this[Pe.values][e]=t,this[Pe.viewopts]=this[Pe.container].props.view(this),this[Pe.status].checked=this.$isValid,this[Pe.refresh]()}})}),this[Pe.container]=t,this[Pe.viewopts]=this[Pe.container].props.view(this)}return y()(e,[{key:"$undo",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this[Pe.values]=JSON.parse(this[Pe.inits]),this[Pe.status].editable=!1,this[Pe.status].checked=!1,this[Pe.status].hidden=!1,t&&this[Pe.refresh](function(){return e[Pe.container].forceUpdateRef("allSelection")})}},{key:"$setHidden",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=this.$hidden;return this[Pe.status].hidden=!0===e,n!==this.$hidden&&this[Pe.refresh](t,!0),this.$hidden}},{key:"$setEditable",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=this.$editable,o=this[Pe.container].selecteds.length>0;return this[Pe.status].editable=!0===t&&this.$fieldOpts.filter(function(t){var n=t.props,r=n.name,o=n.children;return I(void 0===o?[]:o).filter(function(t){var n=t.type,o=t.props.editable;return n===K&&o instanceof Function&&!0===o(e[r],e)}).length>0}).length>0,r!==t&&this[Pe.refresh](function(){o&&e[Pe.container].data.forEach(function(e){return e.$setChecked(!1)}),n()},!0),this.$editable}},{key:"$setChecked",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=this.$checked,o=this.$selectionOpts,i=o.visible,a=void 0!==i&&i,l=o.disabled,s=void 0===l||l;return this[Pe.status].checked=a&&!s&&!0===t,r!==this.$checked&&this[Pe.refresh](function(){e[Pe.container].forceUpdateRef("allSelection",n)},!0),this.$checked}},{key:"$getValid",value:function(e){var t=this,n=this.$fieldOpts.filter(function(t){return t.props.name===e}).map(function(n){var r=n.props,o=r.label,i=r.children;return I(void 0===i?[]:i).map(function(n){var r=n.props,i=r.required,a=void 0!==i&&i,l=r.validation,s=void 0===l?function(){return!0}:l;return a&&F(t[e])?"".concat(o," 必須輸入."):s(t[e],t)})[0]})[0];return!("string"==typeof n&&n.trim().length>0)||n}},{key:Ge,value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=I(this[n?Pe.container:Pe.dataview]);0===r.length?t():r.forEach(function(o,i){return o.forceUpdate(i!==r.length-1?null:function(){n?t():e[Pe.container].forceUpdateRef(["tbar","modal"],t)})})}},{key:"$dataview",set:function(e){this[Pe.dataview]=e}},{key:"$dataviewOpts",get:function(){return this[Pe.viewopts]}},{key:"$fieldOpts",get:function(){var e=this.$dataviewOpts.props.children;return void 0===e?[]:e}},{key:"$json",get:function(){return JSON.parse(JSON.stringify(this[Pe.values]))}},{key:"$uid",get:function(){return this[Pe.uid]}},{key:"$editable",get:function(){return this[Pe.status].editable}},{key:"$checked",get:function(){return this[Pe.status].checked}},{key:"$isNew",get:function(){return this[Pe.status].isNew}},{key:"$hidden",get:function(){return this[Pe.status].hidden}},{key:"$isDirty",get:function(){return this[Pe.inits]!==JSON.stringify(this[Pe.values])}},{key:"$isValid",get:function(){var e=this,t=this.$fieldOpts;return t.filter(function(t){var n=t.props.name;return!0===e.$getValid(n)}).length===t.length}},{key:"$selectionOpts",get:function(){var e=this[Pe.container],t=e[e.state.$GroupSymbol],n=e.editings.length>0,r=this[Pe.viewopts].props.selectable,o=void 0===r?function(){return!1}:r;return{checked:this.$checked,disabled:n&&(!this.$editable||!this.$isDirty||!this.$isValid),visible:(n?this.$editable:t.getAllowedTodos(ge.SELECTION,{strict:!1}).length>0)&&!0===(o instanceof Function?o(this):o)}}}]),e}(),qe=function(e){function t(){return m()(this,t),b()(this,w()(t).apply(this,arguments))}return N()(t,e),y()(t,[{key:"render",value:function(){var e=this.props,t=e.container,n=e.filtering,r=void 0!==n&&n,o=e.options,i=void 0===o?[]:o,l=e.onSwitchFilter,c=void 0===l?function(){}:l;return R.a.createElement("div",{className:"header locked menu"},R.a.createElement(fe,{align:"right",bgColor:"#f7f7f7",txColor:"#5c6b77",display:R.a.createElement("i",{className:"fa fa-bars"})},[R.a.createElement(se,{key:"undo",icon:"fa fa-undo",onClick:function(){return t[Qe.onLayoutChange]("Revert")}},"還原設置"),R.a.createElement(ue,{key:"divider-up",color:"#5c6b77"})].concat(s()(i.filter(function(e){return"string"==typeof e.label}).map(function(e){var n=e.name,o=e.filter,i=void 0===o?null:o,l=e.hideable,s=e.hidden,c=e.label;return R.a.createElement(se,a()({key:n},{icon:s?"fa fa-square-o":"fa fa-check-square",disabled:!l||r&&null!==i,onClick:function(){return t[Qe.onLayoutChange]("Hidden",n,{hidden:s})}}),c)})),[this.isFilterable?R.a.createElement(ue,{key:"divider-down",color:"#5c6b77"}):null,this.isFilterable?R.a.createElement(se,{key:"filter",icon:r?"fa fa-toggle-on":"fa fa-toggle-off",onClick:function(){return c(!r)}},r?"關閉過濾":"開啟過濾"):null])))}},{key:"isFilterable",get:function(){var e=this.props,t=e.container,n=e.options,r=void 0===n?[]:n;return t.pager.total>0&&0===t.editings.length&&r.filter(function(e){var t=e.hidden,n=void 0!==t&&t,r=e.filter;return!n&&null!==(void 0===r?null:r)}).length>0}}]),t}(T.Component),Ue=function(e){function t(){var e,n;m()(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=b()(this,(e=w()(t)).call.apply(e,[this].concat(o))),L()(C()(n),"state",{filterData:new Be(n.props.container,L()({},n.props.name,n.initFilterVal))}),L()(C()(n),"onChange",function(){return n.forceUpdate()}),L()(C()(n),"doClear",function(){var e=n.props.name;n.state.filterData[e]="",n.forceUpdate(function(){return n.doFilter()})}),L()(C()(n),"doFilter",function(){var e=n.props,r=e.container,o=e.name,i=e.filterUID,a=e.filter;r[t.doFilter](i,{name:o,operator:a,value:n.currFilterVal})}),n}return N()(t,e),y()(t,[{key:"render",value:function(){var e=this,t=this.props.name,n=this.state.filterData;return R.a.createElement("th",{className:"filter-header"},R.a.createElement("form",{onSubmit:this.doFilter,onKeyDown:function(t){return 27===t.keyCode?e.doClear():null}},n.$fieldOpts.filter(function(e){return e.props.name===t}).map(function(r){var o=r.props.children,i=I(void 0===o?[]:o).filter(function(e){return e.type===K});if(0===i.length)throw new Error("Filtering must be set <Editor />.");return i.map(function(r){var o=r.props;return R.a.createElement(K,a()({key:"editor"},u()({},o,{name:t,dataModel:n,editable:!0}),{onChange:e.onChange}))})[0]}),R.a.createElement("a",{className:"kekkai-nav-btn",disabled:F(this.currFilterVal),onClick:F(this.currFilterVal)?null:this.doFilter},R.a.createElement("i",{className:"fa fa-filter"})),R.a.createElement("a",{className:"kekkai-nav-btn",disabled:F(this.currFilterVal),onClick:F(this.currFilterVal)?null:this.doClear},R.a.createElement("i",{className:"fa fa-eraser"}))))}},{key:"initFilterVal",get:function(){var e=this.props,t=e.name,n=e.container.state.filters;return(void 0===n?[]:n).filter(function(e){return e.name===t}).map(function(e){return e.value})[0]||""}},{key:"currFilterVal",get:function(){var e=this.props.name;return this.state.filterData[e]}}]),t}(T.Component);L()(Ue,"doFilter",Symbol("DO_FILTER"));var We=function(e){function t(){var e,n;m()(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=b()(this,(e=w()(t)).call.apply(e,[this].concat(o))),L()(C()(n),"state",{resizing:!1,reordering:!1}),L()(C()(n),"onSorting",function(){if(n.sortable){var e=n.props,t=e.name,r=e.sortStatus,o=void 0===r||r,i=e.onSorting;(void 0===i?function(){}:i)(t,o)}}),L()(C()(n),"onStartResizing",function(e){var t=e.clientX,r=n.props,o=r.name,i=r.onStartResizing,a=void 0===i?function(){}:i;n.setState({resizing:!0},function(){return a(o,t)})}),L()(C()(n),"onStartReordering",function(e){ie()(e);var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=n.props,o=r.name,i=r.seq,a=r.onStartReordering;(void 0===a?function(){}:a)(t,{name:o,seq:i})}),L()(C()(n),"onDragOver",function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=n.props,i=o.name,a=o.reordering,l=void 0!==a&&a;(l||{}).name!==i&&e.preventDefault(),e.target.classList[r?"add":"remove"](t.HoveringClassName)}),L()(C()(n),"onDrop",function(e){ie()(e);var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=n.props,o=r.seq,i=r.reordering,a=void 0!==i&&i,l=r.onReorderingDone,s=void 0===l?function(){}:l,c=a||{},u=c.name,d=c.seq;o>d?s(u,t?o-1:o):o<d&&s(u,t?o:o+1)}),n}return N()(t,e),y()(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.label,r=t.name,o=t.filter,i=t.filtering,a=t.resizable,l=t.reorderable,s=void 0!==l&&l,c=t.reordering,u=void 0!==c&&c,d=(u||{}).name;return R.a.createElement("th",{className:this.className,rowSpan:i&&null===o?2:1},u&&d!==r?R.a.createElement("div",{className:"allowed-reordering"},R.a.createElement("div",{className:"before",onDragOver:function(t){return e.onDragOver(t,!0)},onDragLeave:function(t){return e.onDragOver(t,!1)},onDrop:function(t){return e.onDrop(t,!0)}}),R.a.createElement("div",{className:"behind",onDragOver:function(t){return e.onDragOver(t,!0)},onDragLeave:function(t){return e.onDragOver(t,!1)},onDrop:function(t){return e.onDrop(t,!1)}}),R.a.createElement("span",{onClick:this.onSorting},n)):R.a.createElement("div",{draggable:s,onDragStart:function(t){return e.onStartReordering(t,!0)},onDragEnd:function(t){return e.onStartReordering(t,!1)}},R.a.createElement("span",{onClick:this.onSorting},n),this.menu),"string"==typeof n&&a?R.a.createElement("div",{className:"resizable",onMouseDown:this.onStartResizing}):null)}},{key:"sortable",get:function(){var e=this.props.sortable;return!1!==re.getSortable({sortable:e})}},{key:"className",get:function(){if(this.sortable){var e=["sortable"],t=this.props.sortStatus,n=void 0===t||t;return!0!==n&&e.push(n),e.join(" ")}return""}},{key:"menu",get:function(){var e=this.props,t=e.name,n=e.filter,r=e.filtering,o=e.lockable,i=e.locked,a=e.hideable,l=e.onLayoutChange,s=void 0===l?function(){}:l;return o||a?R.a.createElement(fe,{align:"right",bgColor:"#f7f7f7",txColor:"#5c6b77",display:R.a.createElement("i",{className:"fa fa-angle-down"})},o?R.a.createElement(se,{key:"locked",icon:i?"fa fa-unlock-alt":"fa fa-lock",onClick:function(){return s("Locked",t,{locked:i})}},i?"解鎖":"鎖定"):null,a?R.a.createElement(se,{key:"hidden",icon:"fa fa-eye-slash",disabled:r&&null!==n,onClick:function(){return s("Hidden",t,{hidden:!1})}},"隱藏"):null):null}}]),t}(T.Component);function He(e){var t=e.checked,n=void 0!==t&&t,r=e.indeterminate,o=void 0!==r&&r,i=["fa"];return n?i.push("fa-check-square"):o?i.push("fa-minus-square"):i.push("fa-square-o"),i.join(" ")}function Ve(e){var t=e.color,n=void 0===t?"#007bff":t,r=e.visible,o=void 0===r||r,i=e.disabled,a=void 0!==i&&i,l=e.checked,s=void 0!==l&&l,c=e.indeterminate,u=void 0!==c&&c,d=e.onChange,f=void 0===d?function(){}:d;return o?R.a.createElement("button",{type:"button",className:"kekkai-checkbox-selection",disabled:a,onClick:function(){return f(u?s:!s)}},R.a.createElement("i",{className:He(e),style:{color:s||u?n:"#6c757d"}})):null}L()(We,"HoveringClassName","hovering");var Ke=function(e){function t(){return m()(this,t),b()(this,w()(t).apply(this,arguments))}return N()(t,e),y()(t,[{key:"render",value:function(){var e=this.props,t=e.container,n=e.rowSpan,r=void 0===n?1:n,o=t.data,i=void 0===o?[]:o,a=t.selecteds,l=void 0===a?[]:a,s=t.props.toolBgColor,c=void 0===s?"#007bff":s,u=l.length>0&&l.length===i.length;return R.a.createElement("th",{className:"row-selection",rowSpan:r},R.a.createElement(Ve,{color:c,checked:u,visible:0===t.editings.length,indeterminate:!u&&l.length>0,onChange:function(e){return i.forEach(function(t){return t.$setChecked(e)})}}))}}]),t}(T.Component);n(25);function Je(e){var t=e.locked,n=void 0!==t&&t,r=e.selectable,o=void 0!==r&&r,i=e.menus,a=void 0===i?[]:i,l=e.columns,s=void 0===l?[]:l,c=n?(o?Qe.toolWidth:0)+(0===a.length?0:Qe.toolWidth):0;return s.forEach(function(e){var t=e.width,n=void 0===t?$:t;return c+=!1===n?0:"number"!=typeof n||isNaN(n)?function(){throw new Error('Must set a Number or false to <KekkaiField list="...">.')}():n}),c}function Ye(e){var t=e.locked,n=void 0!==t&&t,r=e.selectable,o=void 0!==r&&r,i=e.menus,a=void 0===i?[]:i,l=e.columns,s=void 0===l?[]:l;return R.a.createElement("colgroup",null,n&&o?R.a.createElement("col",{style:{width:Qe.toolWidth}}):null,n&&0!==a.length?R.a.createElement("col",{style:{width:Qe.toolWidth}}):null,s.map(function(e){var t=e.name,n=e.width,r=void 0===n?$:n;return!1===r?null:R.a.createElement("col",{key:t,style:{width:"number"!=typeof r||isNaN(r)?$:r}})}))}function Xe(e){var t=e.locked,n=void 0!==t&&t,r=e.selectable,o=void 0!==r&&r,i=e.menus,a=void 0===i?[]:i,l=e.children,s=void 0===l?[]:l,c=e.columns,u=void 0===c?[]:c;return R.a.createElement("table",{style:{width:Je({locked:n,selectable:o,menus:a,columns:u})}},R.a.createElement(Ye,{locked:n,selectable:o,menus:a,columns:u}),R.a.createElement("tbody",null,s))}var Ze=function(e){function t(){var e,n;m()(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=b()(this,(e=w()(t)).call.apply(e,[this].concat(o))),L()(C()(n),"state",{reordering:!1,resizing:!1,resizeOpts:null}),L()(C()(n),"onStartReordering",function(e,t){var r=t.name,o=t.seq;return n.setState({reordering:!!e&&{name:r,seq:o}})}),L()(C()(n),"onReorderingDone",function(e,t){n.props.container[Qe.onLayoutChange]("Reorder",e,{seq:t})}),L()(C()(n),"onStartResizing",function(e,r){n.setState({resizeOpts:{name:e,x:r,distance:0}},function(){t.Body.addEventListener("mouseover",n.onResizing),t.Body.addEventListener("mouseup",n.onCancelResizing),t.Body.addEventListener("mouseleave",n.onCancelResizing)})}),L()(C()(n),"onCancelResizing",function(){var e=n.props,r=e.container,o=e.columns,i=void 0===o?[]:o,a=n.state.resizeOpts,l=a.name,s=a.distance;n.isResizing&&n.setState({resizeOpts:null},function(){t.Body.removeEventListener("mouseover",n.onResizing),t.Body.removeEventListener("mouseup",n.onCancelResizing),t.Body.removeEventListener("mouseleave",n.onCancelResizing),r[Qe.onLayoutChange]("Resize",l,{width:i.filter(function(e){return e.name===l}).map(function(e){return e.width+s})[0]})})}),L()(C()(n),"onResizing",function(e){var t=e.clientX;if(n.isResizing){var r=n.state.resizeOpts,o=r.name,i=r.x;n.setState({resizeOpts:{name:o,x:i,distance:t-i}})}}),n}return N()(t,e),y()(t,[{key:"render",value:function(){var e=this,t=this.defaultGroupProps,n=this.props,r=n.container,o=n.filtering,i=void 0!==o&&o,l=n.sort,s=void 0===l?[]:l,c=n.menus,d=void 0===c?[]:c,f=n.children,h=t.columns,p=void 0===h?[]:h,v=p.filter(function(e){var t=e.hidden,n=void 0!==t&&t,r=e.filter;return!n&&null!==(void 0===r?null:r)});return R.a.createElement("table",{style:{width:Je(this.defaultGroupProps)}},R.a.createElement(Ye,this.defaultGroupProps),R.a.createElement("thead",null,R.a.createElement("tr",null,f,0===d.length?null:R.a.createElement("th",{rowSpan:i?2:1}," "),p.map(function(t){var n=t.name,r=t.label,o=t.seq,l=t.filter,c=void 0===l?null:l,d=t.sortable,f=t.lockable,h=t.hideable,p=t.resizable,v=t.reorderable;return R.a.createElement(We,a()({key:n},u()({},e.defaultHeaderColProps,{filter:c,filtering:i,name:n,label:r,seq:o,lockable:f,hideable:h,resizable:p,reorderable:v,sortable:d,sortStatus:s.filter(function(e){return e.name===n}).map(function(e){return e.dir})[0]||!0})))})),i&&0!==v.length?R.a.createElement("tr",null,v.map(function(e){var t=e.name,n=e.filter,o=e.filterUID;return R.a.createElement(Ue,a()({key:t},{name:t,filterUID:o,filter:n,container:r}))})):null))}},{key:"isResizing",get:function(){return null!==this.state.resizeOpts}},{key:"resizingName",get:function(){return this.isResizing?this.state.resizeOpts.name:null}},{key:"defaultGroupProps",get:function(){var e=this,t=this.props,n=t.locked,r=void 0!==n&&n,o=t.selectable,i=void 0!==o&&o,a=t.menus,l=void 0===a?[]:a,s=t.columns,c=void 0===s?[]:s;return{locked:r,selectable:i,menus:l,columns:JSON.parse(JSON.stringify(c)).map(function(t){var n=t.name;if(e.isResizing&&e.resizingName===n){var r=e.state.resizeOpts.distance;t.width+=r}return t})}}},{key:"defaultHeaderColProps",get:function(){var e=this.state.reordering,t=this.props,n=t.container,r=t.onSorting,o=t.locked,i=void 0!==o&&o;return{toolColor:n.bgColor,locked:i,reordering:e,onSorting:r,onStartReordering:this.onStartReordering,onReorderingDone:this.onReorderingDone,onStartResizing:this.onStartResizing,onLayoutChange:n[Qe.onLayoutChange]}}}]),t}(T.Component);L()(Ze,"Body",document.body);var Qe=function(e){function t(){var e,n;m()(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=b()(this,(e=w()(t)).call.apply(e,[this].concat(o))),L()(C()(n),"state",{dropdowning:!1,filtering:!1}),L()(C()(n),"onScroll",function(e){var t=e.target,r=t.scrollLeft,o=void 0===r?0:r,i=t.scrollTop,a=void 0===i?0:i;n.refs.unlockedH.scrollLeft=o,n.refs.lockedC.scrollTop=a}),L()(C()(n),"onAllSelectionRender",function(e){n.props.container.refs.allSelection=e}),L()(C()(n),"onDropdownMenu",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return n.setState({dropdowning:e})}),L()(C()(n),"onSwitchFilter",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=n.props.options;n.setState({filtering:e&&t.filter(function(e){var t=e.hidden,n=void 0!==t&&t,r=e.filter;return!n&&null!==(void 0===r?null:r)}).length>0})}),n}return N()(t,e),y()(t,[{key:"getFieldChildren",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return I(e).filter(function(e){var n=e.type,r=e.key,o=e.props.name,i=void 0===o?r:o;return n===re&&t.filter(function(e){return e.name===i}).length>0}).sort(function(e,n){var r=e.props.name,o=n.props.name,i=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.filter(function(e){return e.name===r})[0]||{}).seq,a=void 0===i?0:i,l=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.filter(function(e){return e.name===o})[0]||{}).seq;return a-(void 0===l?0:l)})}},{key:"render",value:function(){var e=this,n=this.props,r=n.container,o=n.manager,i=n.options,l=n.selectable,s=void 0!==l&&l,c=n.children,d=void 0===c?[]:c,f=this.state.dropdowning,h=i.filter(function(e){var t=e.locked;return!e.hidden&&!0===t}),p=i.filter(function(e){var t=e.locked;return!e.hidden&&!0!==t}),v=this.isFiltering,m=o.getAllowedTodos(ge.ROW_MENU,{strict:!1});if(0===p.length)throw new Error("The count of unlocked columns must be at least one.");return R.a.createElement("div",{className:"kekkai-list-panel"},R.a.createElement("div",{className:r.editings.length>0?"editing":""},R.a.createElement("div",{ref:"lockedH",className:"header locked"},R.a.createElement(Ze,a()({locked:!0,menus:m,columns:h},this.defaultHeaderProps),s?R.a.createElement(Ke,{ref:this.onAllSelectionRender,container:r,rowSpan:v?2:1}):null)),R.a.createElement("div",{ref:"unlockedH",className:"header"},R.a.createElement(Ze,a()({locked:!1,columns:p},this.defaultHeaderProps))),R.a.createElement(qe,a()({container:r,options:i,filtering:v},{onSwitchFilter:this.onSwitchFilter}))),I(d).length>0?null:R.a.createElement("div",{className:"data-not-found"},R.a.createElement("div",{ref:"lockedC",className:"content locked",style:{width:Je({locked:!0,selectable:s,columns:h})}}),R.a.createElement("div",{ref:"unlockedC",className:"content",onScroll:this.onScroll},R.a.createElement("div",{style:{height:1,width:Je({locked:!1,selectable:s,columns:p})}}))),0===I(d).length?null:R.a.createElement("div",{className:f?"dropdowning":""},R.a.createElement("div",{ref:"lockedC",className:"content locked"},R.a.createElement(Xe,{locked:!0,menus:m,columns:h,selectable:s},I(d).map(function(t){return R.a.createElement(at,a()({key:t.key,locked:!0,onDropdownMenu:e.onDropdownMenu},u()({},t.props,e.defaultDataviewProps,{panel:W.List,ref:"locked-".concat(t.props.dataModel.$uid)})),e.getFieldChildren(t.props.children,h).map(function(e){return R.a.createElement(re,a()({key:e.props.name||e.key},e.props,{locked:!0}))}))}))),R.a.createElement("div",{ref:"unlockedC",className:"content",onScroll:this.onScroll},R.a.createElement(Xe,{locked:!1,columns:p},I(d).map(function(n){return R.a.createElement(at,a()({key:n.key,locked:!1},u()({},n.props,e.defaultDataviewProps,L()({panel:W.List},t.onGetLockedRow,function(){return e.refs["locked-".concat(n.props.dataModel.$uid)]}))),e.getFieldChildren(n.props.children,p).map(function(e){return R.a.createElement(re,a()({key:e.props.name||e.key},e.props,{locked:!1}))}))})))))}},{key:"isFiltering",get:function(){var e=this.props.container,t=this.state.filtering;return 0===e.editings.length&&t}},{key:"defaultHeaderProps",get:function(){var e=this.props,t=e.container,n=e.onSorting,r=e.selectable,o=void 0!==r&&r,i=e.sort,a=void 0===i?[]:i;return{container:t,filtering:this.isFiltering,selectable:o,sort:a,onSorting:n}}},{key:"defaultDataviewProps",get:function(){var e=this.props;return{owner:e.owner,container:e.container,manager:e.manager}}}]),t}(T.Component);L()(Qe,"onLayoutChange",Symbol("ON_LAYOUT_CHANGE")),L()(Qe,"onGetLockedRow",_()),L()(Qe,"defaultColumnWidth",120),L()(Qe,"toolWidth",48);var et={getListRowClassName:Symbol("GET_LIST_ROW_CLASS_NAME"),getCardRowClassName:Symbol("GET_CARD_ROW_CLASS_NAME"),onRelaction:Symbol("ON_RELACTION"),onListRowRender:Symbol("ON_LIST_ROW_RENDER"),onSelected:Symbol("ON_SELECTED")},tt=et.getListRowClassName,nt=et.getCardRowClassName,rt=et.onListRowRender,ot=et.onRelaction,it=et.onSelected,at=function(e){function t(e){var n;return m()(this,t),n=b()(this,w()(t).call(this,e)),L()(C()(n),rt,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=(0,n.props[Qe.onGetLockedRow])();if(t&&null!==e){var r=t.refs.listrow;e.style.height="".concat(Math.max(e.clientHeight,r.clientHeight,38),"px"),r.style.height=e.style.height,function(e,t){[{name:"mousedown",fn:q,value:!0},{name:"mouseup",fn:q,value:!1},{name:"mouseover",fn:U,value:!0},{name:"mouseleave",fn:[U,q],value:!1},{name:"mouseout",fn:[U,q],value:!1}].forEach(function(n){var r=n.name,o=n.fn,i=n.value;e.addEventListener(r,function(n){return I(o).forEach(function(r){return r(i,e,t,n)})}),t.addEventListener(r,function(n){return I(o).forEach(function(r){return r(i,e,t,n)})})})}(r,e),n[et.onRelaction](n.props)}}),L()(C()(n),it,function(e){var t=n.props,r=t.dataModel,o=t.onSelected,i=void 0===o?function(){}:o;r.$setChecked(e,function(){return i(r.$checked)})}),n[et.onRelaction](e),n}return N()(t,e),y()(t,[{key:"componentWillReceiveProps",value:function(e){this[et.onRelaction](e)}},{key:ot,value:function(e){var t=e.dataModel,n=e.locked,r=void 0===n?this.props.container:n,o=e[Qe.onGetLockedRow],i=void 0===o?this.props[Qe.onGetLockedRow]:o;if(W.List!==this.panel&&i)throw new Error("Only panel(list) could set event(onGetLockedRow).");if(!t)throw new Error("<KekkaiDataview /> must be binding props(dataModel).");W.List!==this.panel||r?W.List!==this.panel&&(t.$dataview=this):t.$dataview=[i(),this]}},{key:"render",value:function(){var e=this,t=this.props,n=t.owner,r=t.container,o=t.manager,i=t.dataModel,l=t.locked,s=void 0!==l&&l,c=t.onDropdownMenu,d=void 0===c?function(){}:c,f=r.bgColor,h=(r.txColor,o.getAllowedTodos(ge.ROW_DBCLICK,{targetData:i})),p=s||W.Card===this.panel?o.getAllowedTodos(ge.ROW_MENU,{targetData:i}):[];switch(this.panel){case W.Form:return R.a.createElement("div",{className:"kekkai-dataview row"},this.fields.map(function(t,o){return R.a.createElement(re,a()({key:t.props.name||t.key},u()({},t.props,{dataModel:i,owner:n,container:r,dataview:e,sortable:re.getSortable(t.props,{seq:o})})))}));case W.Card:return R.a.createElement("div",{className:this[et.getCardRowClassName]},R.a.createElement("div",{className:"card container"},0===p.length?null:R.a.createElement("div",{className:"card-header"},R.a.createElement(fe,{bgColor:"#f7f7f7",txColor:"#5c6b77",align:"right",onOpen:function(){return d(!0)},onClose:function(){return d(!1)},display:R.a.createElement("i",{className:"fa fa-bars"})},p.map(function(e){return R.a.createElement(se,{key:e.uuid,icon:e.icon,onClick:function(){return e.execute(ge.SELECTION===e.trigger?{list:[i]}:{data:i})}},e.text)}))),R.a.createElement("div",{className:"card-body row"},this.fields.map(function(t,o){return R.a.createElement(re,a()({key:t.props.name||t.key},u()({},t.props,{dataModel:i,owner:n,container:r,dataview:e,sortable:re.getSortable(t.props,{seq:o})})))}))));case W.List:return R.a.createElement("tr",{className:I([this[et.getListRowClassName],0===h.length?"":"row-pointer"]).join(" "),ref:s?"listrow":this[et.onListRowRender],onDoubleClick:0===h.length?null:function(){return h[0].execute({data:i})}},s&&r.allselectable?R.a.createElement("td",{className:"row-selection"},R.a.createElement(Ve,u()({},i.$selectionOpts,{color:f,onChange:this[et.onSelected]}))):null,0===p.length?null:R.a.createElement("td",{className:"row-menu"},R.a.createElement(fe,{bgColor:"#f7f7f7",txColor:"#5c6b77",onOpen:function(){return d(!0)},onClose:function(){return d(!1)},display:R.a.createElement("i",{className:"fa fa-bars"})},p.map(function(e){return R.a.createElement(se,{key:e.uuid,icon:e.icon,onClick:function(){return e.execute({data:i})}},e.text)}))),this.fields.map(function(t,o){return R.a.createElement(re,a()({key:t.props.name||t.key},u()({},t.props,{dataModel:i,owner:n,container:r,dataview:e,sortable:re.getSortable(t.props,{seq:o})})))}))}}},{key:"panel",get:function(){return this.props.panel||W.List}},{key:"labelSize",get:function(){return this.props.labelSize||t.defaultLabelSize}},{key:"$owner",get:function(){return this.props.owner}},{key:"$container",get:function(){return this.props.container}},{key:"fields",get:function(){return I(this.props.children).filter(function(e){return e.type===re})}},{key:tt,get:function(){var e=["kekkai-dataview"];return this.props.dataModel.$isValid||e.push("invalid-row"),e.join(" ")}},{key:nt,get:function(){var e=this.props,t=e.dataModel,n=["kekkai-dataview","container",z(e.viewSize)];return t.$isValid||n.push("invalid-row"),n.join(" ")}}]),t}(T.Component);L()(at,"defaultLabelSize",null);n(26);var lt=function(e){function t(){return m()(this,t),b()(this,w()(t).apply(this,arguments))}return N()(t,e),y()(t,[{key:"render",value:function(){var e=this,t=this.props.children,n=void 0===t?[]:t;return R.a.createElement("div",{className:"kekkai-form-panel container"},I(n).length>0?null:R.a.createElement("div",{className:"data-not-found"}),I(n).map(function(t){return R.a.createElement(at,a()({key:t.key,panel:W.Form},u()({},t.props,e.defaultDataviewProps)))}))}},{key:"defaultDataviewProps",get:function(){var e=this.props,t=e.container;return{owner:e.owner,container:t,manager:e.manager}}}]),t}(T.Component),st=(n(27),function(e){function t(){var e,n;m()(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=b()(this,(e=w()(t)).call.apply(e,[this].concat(o))),L()(C()(n),"state",{dropdowning:!1}),L()(C()(n),"onDropdownMenu",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return n.setState({dropdowning:e})}),n}return N()(t,e),y()(t,[{key:"render",value:function(){var e=this,t=this.props,n=(t.owner,t.container,t.manager,t.sort,t.options,t.children),r=void 0===n?[]:n;return R.a.createElement("div",{className:"kekkai-card-panel"},R.a.createElement("div",null,I(r).length>0?null:R.a.createElement("div",{className:"data-not-found"}),I(r).map(function(t){return R.a.createElement(at,a()({key:t.key,panel:W.Card,onDropdownMenu:e.onDropdownMenu},u()({},t.props,e.defaultDataviewProps)))})))}},{key:"defaultDataviewProps",get:function(){var e=this.props,t=e.container;return{owner:e.owner,container:t,manager:e.manager}}}]),t}(T.Component));function ct(e){var t=e.color,n=void 0===t?"primary":t,r=e.icon,o=e.text,i=e.disabled,a=e.onClick,l=void 0===a?function(){}:a,s=i instanceof Function?i:function(){return!0===i};return R.a.createElement("button",{type:"button",className:["kekkai-btn",n].join(" "),disabled:s(),onClick:l},"string"!=typeof r||0===r.trim().length?null:R.a.createElement("i",{className:r}),o)}var ut="kekkai-snack-mask",dt={onTrigger:_()};function ft(e){var t=e.type,n=e.icon,r=e.show,o=void 0!==r&&r,i=e.title,l=e.content,s=e.onClose,c=void 0===s?function(){}:s;return R.a.createElement(vt,a()({type:t,show:o},{vertical:"top",delay:!1,mask:!0,onClose:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return c("confirm",e)}}),R.a.createElement(pt,a()({key:"content"},{icon:n,title:i,content:l},{btns:[{icon:"fa fa-times",color:"secondary",text:"取消",value:!1},{icon:"fa fa-check",color:"primary",text:"確定",value:!0}]})))}function ht(e){var t=e.type,n=e.icon,r=e.show,o=void 0!==r&&r,i=e.title,l=e.content,s=e.onClose,c=void 0===s?function(){}:s;return R.a.createElement(vt,a()({key:"content"},{type:t,show:o},{delay:5e3,onClose:function(){return c("alert")}}),R.a.createElement(pt,{icon:n,title:i,content:l}))}function pt(e){var t=e.icon,n=e.title,r=e.content,o=e.btns,i=void 0===o?[]:o,l=e[dt.onTrigger],s=void 0===l?function(){}:l;return R.a.createElement("div",{className:"snackbar-content"},R.a.createElement("div",{className:"body"},"string"!=typeof t||0===t.trim().length?null:R.a.createElement("strong",null,R.a.createElement("i",{className:t})),R.a.createElement("div",null,"string"!=typeof n||0===n.trim().length?null:R.a.createElement("h3",{className:"snackbar-title"},n),r)),i&&0!==i.length?R.a.createElement("div",{className:"footer"},Array.isArray(i)?i.filter(function(e){return null!==e}).map(function(e){var t=e.icon,n=e.text,r=e.value,o=e.color,i=void 0===o?"primary":o;return R.a.createElement(ct,a()({key:r},{color:i,icon:t,text:n},{onClick:function(){return s(r)}}))}):i):null)}var vt=function(e){function t(){var e,n;m()(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=b()(this,(e=w()(t)).call.apply(e,[this].concat(o))),L()(C()(n),"delayID",null),L()(C()(n),"state",{height:0}),L()(C()(n),"doClose",function(e){var t=n.props.onClose;(void 0===t?function(){}:t)(e)}),L()(C()(n),"onSnackbarRender",function(e){var t=n.props.mask,r=void 0!==t&&t,o=function t(r){var o=r.target;e.contains(o)||(n.doClose(),document.body.classList.remove(ut),document.body.removeEventListener("click",t))};e?n.setState({height:e.clientHeight},function(){n.setDelayClose(),r&&(document.body.classList.add(ut),document.body.addEventListener("click",o))}):r&&(document.body.classList.remove(ut),document.body.removeEventListener("click",o))}),n}return N()(t,e),y()(t,[{key:"setDelayClose",value:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props).delay,n=void 0===t?5e3:t;clearTimeout(this.delayID),"TIMEOUT"===this.closeMode&&(this.delayID=setTimeout(function(){e.doClose(),clearTimeout(e.delayID)},n))}},{key:"render",value:function(){var e=this,t=this.props,n=t.show,r=void 0!==n&&n,o=t.type,i=void 0===o?"info":o,l=t.vertical,s=void 0===l?"bottom":l,c=t.children,d=void 0===c?[]:c,f=this.state.height;if(["info","success","warning","danger"].indexOf(i)<0)throw new Error('The type of Snackbar must be "info"/"success"/"warning"/"danger".');return r?R.a.createElement("div",{ref:this.onSnackbarRender,className:["kekkai-snackbar",i].join(" "),style:L()({},"top"===s?"marginBottom":"marginTop",-1*f)},I(d).map(function(t){return pt!==t.type?t:R.a.createElement(pt,a()({key:t.key},u()({},t.props,L()({},dt.onTrigger,function(t){return e.doClose(t)}))))})):null}},{key:"closeMode",get:function(){var e=this.props.delay;return!1===(void 0===e?5e3:e)?"TRIGGER":"TIMEOUT"}}]),t}(T.Component);n(28);function mt(e){var t=e.title,n=e.icon,r=e.bgColor,o=e.txColor,i=e.onClose,a=void 0===i?function(){}:i;return R.a.createElement("div",{className:"header",style:{backgroundColor:r,color:o}},R.a.createElement("h3",{className:"title"},"string"!=typeof n||0===n.trim().length?null:R.a.createElement("i",{className:n}),t),R.a.createElement("button",{type:"button",className:"close",onClick:a,style:{color:o}},R.a.createElement("span",null,"×")))}var gt=function(e){function t(){var e,n;m()(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=b()(this,(e=w()(t)).call.apply(e,[this].concat(o))),L()(C()(n),"doClose",function(e){var t=n.props.onClose;(void 0===t?function(){}:t)(e)}),L()(C()(n),"onTrigger",function(){var e=p()(f.a.mark(function e(t){var r,o;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.props.onTrigger,o=void 0===r?function(){}:r,e.next=3,o(t);case 3:!1!==e.sent&&n.doClose(t);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n}return N()(t,e),y()(t,[{key:"render",value:function(){var e=this,t=this.props.show,n=void 0!==t&&t,r=this.props,o=r.icon,i=r.title,l=r.bgColor,s=r.txColor,c=r.zIndex,u=void 0===c?1e3:c,d=r.closeByMask,f=void 0===d||d,h=r.children,p=void 0===h?[]:h,v=r.btns,m=void 0===v?[]:v,g=r.alert,y=void 0===g?{type:"info",icon:null,title:null,show:!1,content:null,callbackFn:null}:g,k=r.confirm,b=void 0===k?{type:"info",icon:null,title:null,show:!1,content:null,callbackFn:null}:k,E=r.onCloseMessage,w=void 0===E?function(){}:E;return n?R.a.createElement("div",{className:"kekkai-modal",style:{zIndex:u},onClick:function(){return f?e.doClose():null}},R.a.createElement("div",{className:"dialog"},R.a.createElement("div",{className:"content"},"string"!=typeof i||0===i.trim().length?null:R.a.createElement(mt,a()({icon:o,title:i,bgColor:l,txColor:s},{onClose:function(){return e.doClose()}})),R.a.createElement("div",{className:"body"},R.a.createElement(ft,a()({},b,{onClose:w})),p,R.a.createElement(ht,a()({},y,{onClose:w}))),m&&0!==m.length?R.a.createElement("div",{className:"footer"},Array.isArray(m)?m.filter(function(e){return null!==e}).map(function(t){var n=t.icon,r=t.text,o=t.value,i=t.disabled,l=void 0!==i&&i,s=t.color,c=void 0===s?"primary":s;return R.a.createElement(ct,a()({key:o},{color:c,icon:n,text:r,disabled:l},{onClick:function(){return e.onTrigger(o)}}))}):m):null))):null}}]),t}(T.Component),yt={button:Symbol("Button"),concat:Symbol("Concat")},kt=function(e){function t(){return m()(this,t),b()(this,w()(t).apply(this,arguments))}return N()(t,e),y()(t,[{key:"getExecuteParams",value:function(e){var t=this.props.manager.container,n=W.Form===t.panel;switch(e.trigger){case ge.TOOLBAR:return{data:null,list:t.data};case ge.SELECTION:return{data:null,list:n?t.data:t.selecteds};default:return n?{data:t.data[0],list:[]}:{data:null,list:t.data}}}},{key:"render",value:function(){var e=this,t=this.props,n=t.bgColor,r=t.txColor,o=t.manager,i=o.container;return R.a.createElement(he,{className:"toolbar",style:{backgroundColor:n,color:r}},R.a.createElement(de,null,this.navitems.map(function(t){var o=t.type,i=t.key,a=t.$todo;return yt.button===o?R.a.createElement(se,{key:a.uuid,icon:a.icon,onClick:function(){return a.execute(e.getExecuteParams(a))}},a.text):R.a.createElement(fe,{key:i,tag:"li",bgColor:n,txColor:r,display:R.a.createElement("span",null,i," ",R.a.createElement("i",{className:"fa fa-caret-down"}))},a.map(function(t){return R.a.createElement(se,{key:t.uuid,icon:t.icon,onClick:function(){return t.execute(e.getExecuteParams(t))}},t.text)}))})),R.a.createElement(de,null,0===i.modifieds.length?null:R.a.createElement(se,{icon:"fa fa-floppy-o",onClick:function(){return o.container.doCommit()}},"儲存"),0===i.editings.length?null:R.a.createElement(se,{icon:"fa fa-undo",onClick:function(){return i.doRollback()}},"取消")))}},{key:"navitems",get:function(){var e=this.props.manager,t=e.container,n=W.Form===t.panel,r=t.selecteds.length>0,o=[];return e.getAllowedTodos(r?ge.SELECTION:ge.TOOLBAR,n?{targetData:t.data[0]}:void 0).forEach(function(e){if(null===e.concat)o.push({type:yt.button,$todo:e});else{var t=o.filter(function(t){return yt.concat===t.type&&t.key===e.concat})[0]||null;null===t?o.push({type:yt.concat,key:e.concat,$todo:[e]}):t.$todo.push(e)}}),o.map(function(e){return yt.button===e.type||e.$todo.length>1?e:{type:yt.button,$todo:e.$todo[0]}})}}]),t}(T.Component);function bt(e){var t=e.bgColor,n=e.txColor,r=e.pager,o=e.onRefresh;return R.a.createElement(he,{className:"pagerbar",style:{backgroundColor:t,color:n}},R.a.createElement(de,null,R.a.createElement(se,{icon:"fa fa-step-backward",disabled:1===r.page,onClick:function(){return r.toFirst()}}),R.a.createElement(se,{icon:"fa fa-chevron-left",disabled:1===r.page,onClick:function(){return r.toPrev()}}),R.a.createElement(ce,{type:"number",className:"pager-input",min:"1",max:r.maxPage,value:r.page,onChange:function(e){var t=e.target;return r.page=parseFloat(t.value)}}),R.a.createElement(se,{icon:"fa fa-chevron-right",disabled:r.page===r.maxPage,onClick:function(){return r.toNext()}}),R.a.createElement(se,{icon:"fa fa-step-forward",disabled:r.page===r.maxPage,onClick:function(){return r.toLast()}}),1===r.pageSize?null:R.a.createElement(fe,{tag:"li",bgColor:t,txColor:n,display:100===r.pageSize?"顯示全部資料":"每頁 ".concat(r.pageSize," 筆")},R.a.createElement(se,{key:"all",onClick:function(){return r.pageSize=100}},"顯示全部資料"),R.a.createElement(ue,{key:"divider",color:n}),R.a.createElement(se,{key:"50",onClick:function(){return r.pageSize=50}},"50 筆"),R.a.createElement(se,{key:"25",onClick:function(){return r.pageSize=25}},"25 筆"),R.a.createElement(se,{key:"10",onClick:function(){return r.pageSize=10}},"10 筆"))),R.a.createElement(de,{align:"right"},R.a.createElement(le,null,"顯示 ",r.start,"-",r.end," 筆 / 共 ",r.maxPage," 頁"),0===r.total?null:R.a.createElement(se,{icon:"fa fa-refresh",onClick:o})))}var Et={options:Symbol("OPTIONS"),status:Symbol("STATUS"),doChange:Symbol("DO_CHANGE")},wt=Et.options,St=Et.status,Ct=Et.doChange,Ot=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};m()(this,e),L()(this,wt,{}),L()(this,St,{total:0,currPage:1}),this[Et.options]={pageSize:t,onPagerChange:n}}return y()(e,[{key:"toNext",value:function(){this.page=Math.min(this.maxPage,this.page+(this.page*this.pageSize<this.total?1:0))}},{key:"toPrev",value:function(){this.page=Math.max(1,this.page-(this.page>1?1:0))}},{key:"toFirst",value:function(){this.page=1}},{key:"toLast",value:function(){this.page=Math.ceil(this.total/this.pageSize)}},{key:Ct,value:function(e,t,n){t!==n&&this[Et.options].onPagerChange(e,this)}},{key:"total",get:function(){return this[Et.status].total},set:function(e){var t=this.total;this[Et.status].total="number"!=typeof e||isNaN(e)?0:e,this[Et.doChange]("TOTAL",t,this.total)}},{key:"page",get:function(){return this[Et.status].currPage},set:function(e){var t=this.page;this[Et.status].currPage=Math.min(Math.max(1,"number"!=typeof e||isNaN(e)?t:e),this.maxPage),this[Et.doChange]("PAGE",t,this.page)}},{key:"pageSize",get:function(){return this[Et.options].pageSize},set:function(e){var t=this.pageSize,n=this.start;this[Et.options].pageSize="number"!=typeof e||isNaN(e)?t:e,this[Et.status].currPage=Math.max(1,Math.ceil(n/this.pageSize)),this[Et.doChange]("PAGE_SIZE",t,this.pageSize)}},{key:"maxPage",get:function(){return Math.max(1,Math.ceil(this.total/this.pageSize))}},{key:"skip",get:function(){return(this.page-1)*this.pageSize}},{key:"start",get:function(){return this.skip+1}},{key:"end",get:function(){return Math.max(1,Math.min(this.skip+this.pageSize,this.total))}},{key:"params",get:function(){return{page:this.page,pageSize:this.pageSize,skip:this.skip,start:this.start}}}]),e}(),Nt=(n(29),n(30),{initData:Symbol("INIT_DATA"),dataviews:Symbol("DATAVIEWS"),modalProps:Symbol("MODAL_PROPS"),isModalOpen:Symbol("IS_MODAL_OPEN"),getContainerClassName:Symbol("GET_CONTAINER_CLASS_NAME"),onPagerChange:Symbol("ON_PAGER_CHANGE"),onSorting:Symbol("ON_SORTING"),onRefresh:Symbol("ON_REFRESH"),onCloseMessage:Symbol("ON_CLOSE_MESSAGE"),onCloseModal:Symbol("ON_MODAL_CLOSE"),onModalTrigger:Symbol("ON_MODAL_TRIGGER")}),xt=Nt.initData,Lt=Nt.getContainerClassName,Tt=Nt.dataviews,Rt=Nt.isModalOpen,Mt=Nt.modalProps,At=Nt.onPagerChange,Pt=Nt.onSorting,Dt=Nt.onRefresh,$t=Nt.onCloseMessage,_t=Nt.onCloseModal,It=Nt.onModalTrigger,Ft=Qe.onLayoutChange,zt=Ue.doFilter,jt=function(e){function t(e){var n,r,o;m()(this,t),n=b()(this,w()(t).call(this,e)),L()(C()(n),xt,new Be(C()(n))),L()(C()(n),"state",{$GroupSymbol:Symbol("GROUP"),$PagerSymbol:Symbol("PAGER"),alert:{type:"info",icon:null,title:null,show:!1,content:null,callbackFn:null},confirm:{type:"info",icon:null,title:null,show:!1,content:null,callbackFn:null},columns:(o=n.props.panel,W.List===o?B(n[Nt.initData]):W.Card===o?G(n[Nt.initData]):[]),data:[],filters:[],executing:{todo:null,data:null,popup:!1},sort:(r=n[Nt.initData],r.$fieldOpts.filter(function(e){var t=e.type,n=e.props.sortable;return t===re&&"boolean"!=typeof(void 0!==n&&n)}).map(function(e){var t=e.props,n=t.name,r=t.sortable,o=e.$sortable,i=void 0===o?re.getSortable({sortable:r}):o;return{name:n,dir:i.dir.toLowerCase(),seq:i.seq}}).sort(function(e,t){return e.seq-t.seq}).map(function(e){return{name:e.name,dir:e.dir}}))}),L()(C()(n),At,function(e,t){var r=n.state,o=r.data,i=r.$PagerSymbol;n.setState({data:"PAGE_SIZE"===e&&100===t.pageSize?[]:o,$PagerSymbol:j(C()(n),i)},"TOTAL"===e?null:n[Nt.onRefresh])}),L()(C()(n),Pt,function(e,t){var r=n.state.sort,o=void 0===r?[]:r;if(!(n.editings.length>0)){if(!0===t)o.push({name:e,dir:"asc"});else switch(t.toLowerCase()){case"asc":o.filter(function(t){return t.name===e}).forEach(function(e){return e.dir="desc"});break;case"desc":o.splice(o.findIndex(function(t){return t.name===e}),1)}n.setState({sort:o},n[Nt.onRefresh])}}),L()(C()(n),Dt,p()(f.a.mark(function e(){var t,r,o,i,a,l,s,c,u,d,h,p;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.getSearchResponse,r=void 0===t?function(){}:t,o=n.state,i=o.filters,a=void 0===i?[]:i,l=o.sort,s=void 0===l?[]:l,e.next=4,r({filters:a.map(function(e){return{name:e.name,operator:e.operator,value:e.value}}),sort:s,page:n.pager.params});case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0={};case 7:c=e.t0,u=c.data,d=void 0===u?[]:u,h=c.total,p=void 0===h?0:h,n.setState({data:d.map(function(e){return new Be(C()(n),e)})},function(){return n.pager.total=p});case 13:case"end":return e.stop()}},e)}))),L()(C()(n),$t,function(e,t){var r=n.state[e],o=r.type,i=r.icon,a=r.title,l=r.content,s=r.callbackFn;n.setState(L()({},e,{type:o,icon:i,title:a,content:l,show:!1}),function(){return s instanceof Function?s(t):null})}),L()(C()(n),_t,function(e){var t=n.state.executing,r=t.todo,o=void 0===r?null:r,i=t.data,a=void 0===i?null:i,l=n.state.alert;n.setState({executing:{todo:o,data:a,popup:!1},alert:!0===e?l:{type:"info",icon:null,title:null,show:!1,content:null,callbackFn:null},confirm:{type:"info",icon:null,title:null,show:!1,content:null,callbackFn:null}},!0===e?null:function(){n.doRollback()})}),L()(C()(n),It,function(){var e=p()(f.a.mark(function e(t){var r,o,i,a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=C()(n),o=n.state.executing,i=o.todo,a=o.data,e.next=4,new Promise(function(e){r.setExecuting({popup:!1,todo:i,data:a},p()(f.a.mark(function o(){var l;return f.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,!0===t?n.doCommit():n.doRollback();case 2:!1!==(l=o.sent)?e(l):r.setExecuting({popup:!0,todo:i,data:a,keepMsg:!0},function(){e(l)});case 4:case"end":return o.stop()}},o)})))});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),L()(C()(n),Ft,function(e,t,r){var o=r.seq,i=r.locked,a=void 0!==i&&i,l=r.hidden,s=void 0!==l&&l,c=r.width,d=void 0===c?0:c,f=n.state.columns,h=void 0===f?[]:f;if("Revert"===e)n.setState({columns:B(n[Nt.initData])});else if("Reorder"===e){var p=h.filter(function(e){return e.name===t}).map(function(e){return e.seq})[0];if(p!==o){for(var v=[].concat(h),m=o>p,g=Math.min(p,o);g<=Math.max(p,o);g++)v[g].seq=g===p?o:m?v[g].seq-1:v[g].seq+1;n.setState({columns:v.sort(function(e,t){return e.seq-t.seq})})}}else n.setState({columns:h.map(function(n){if(n.name===t)switch(e){case"Locked":n.locked=!a;break;case"Hidden":n.hidden=!s;break;case"Resize":n.width=d}return n}).sort(function(e,t){var n=e.locked,r=void 0!==n&&n,o=t.locked;return r===(void 0!==o&&o)?0:!0===r?-1:1}).map(function(e,t){return u()({},e,{seq:t})})})}),L()(C()(n),zt,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.name,o=t.operator,i=t.value,a=n.state.filters,l=void 0===a?[]:a,s=l.filter(function(t){return t.$uid===e})[0];s?F(i)?l.splice(l.indexOf(s),1):s.value=i:F(i)||l.push({$uid:e,name:r,operator:o,value:i}),n.doSearch(JSON.parse(JSON.stringify(l)))});var i=n.state,a=i.$GroupSymbol,l=i.$PagerSymbol;return n[a]=new Le(C()(n),I(n.props.todos)),n[l]=new Ot(n.props.pageSize,function(e,t){return n[Nt.onPagerChange](e,t)}),n}return N()(t,e),y()(t,[{key:"componentWillReceiveProps",value:function(e){var t,n=this;"todos"in e&&this.setState({$GroupSymbol:j(this,this.state.$GroupSymbol)},function(){var t=n.state.$GroupSymbol;n[t]=new Le(n,I(e.todos))}),"panel"in e&&W.Form===e.panel?this.pager.pageSize=1:"pageSize"in e&&(this.pager.pageSize=e.pageSize),"panel"in e&&this.setState({columns:(t=e.panel,W.List===t?B(n[Nt.initData]):W.Card===t?G(n[Nt.initData]):[])})}},{key:"setAlert",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.type,r=void 0===n?"info":n,o=t.title,i=void 0===o?"":o,a=t.icon,l=void 0===a?null:a,s=t.callbackFn,c=void 0===s?null:s,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};this.setState({alert:{type:r,icon:l,title:i,content:e,callbackFn:c,show:!0}},u)}},{key:"setConfirm",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.type,r=void 0===n?"info":n,o=t.title,i=void 0===o?"":o,a=t.icon,l=void 0===a?null:a,s=t.callbackFn,c=void 0===s?function(){}:s,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};this.setState({confirm:{type:r,icon:l,title:i,content:e,callbackFn:c,show:!0}},u)}},{key:"setExecuting",value:function(e){var t=e.todo,n=void 0===t?this.executingTodo:t,r=e.data,o=void 0===r?this.executingData:r,i=e.popup,a=void 0!==i&&i,l=e.keepMsg,s=void 0!==l&&l,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this.setState(u()({executing:{todo:n,data:o,popup:a}},s?{}:{alert:{type:"info",icon:null,title:null,show:!1,content:null,callbackFn:null},confirm:{type:"info",icon:null,title:null,show:!1,content:null,callbackFn:null}}),c)}},{key:"forceUpdateRef",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=I(e).filter(function(e){return"string"==typeof e&&e.trim().length>0&&e in t.refs});0===r.length?n():r.forEach(function(e,o){return t.refs[e].forceUpdate(o===r.length-1?n:null)})}},{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.index,r=void 0===n?0:n,o=t.callbackFn,i=void 0===o?function(){}:o,a=this.state.data,l=void 0===a?[]:a;l.splice(r,0,e),this.setState({data:l},i)}},{key:"edit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,n=t.editData,r=void 0===n?null:n,o=t.callbackFn,i=void 0===o?function(){}:o,a=null===r?this.data:I(r);a.filter(function(t,n){return!t.$isNew&&t.$setEditable(e,n<a.length-1?void 0:i)})}},{key:"doRollback",value:function(){var e=p()(f.a.mark(function e(){var t,n,r,o,i=arguments;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(i.length>0&&void 0!==i[0])||i[0],n=this,r=this.data,o=s()(r),0!==this.modifieds.length&&t){e.next=10;break}r.forEach(function(e){return e.$isNew?o.splice(o.indexOf(e),1):e.$undo(!1)}),this.setState({data:o}),e.next=13;break;case 10:return e.next=12,new Promise(function(e){n.setConfirm("確認放棄目前已變更之資料 ?",{type:"warning",title:"請確認",icon:"fa fa-question",callbackFn:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(r.forEach(function(e){return e.$isNew?o.splice(o.indexOf(e),1):e.$undo(!1)}),n.setState({data:o},function(){return e()})):e(!1)}})});case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"doSearch",value:function(){var e=p()(f.a.mark(function e(){var t,n,r,o,i,a,l=this,s=arguments;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]?s[0]:[],n=s.length>1&&void 0!==s[1]?s[1]:1,r=this.state.filters,o=void 0===r?[]:r,i=this.pager.page,a=void 0===i?1:i,JSON.stringify(t)===JSON.stringify(o)){e.next=8;break}this.setState({filters:t},function(){return l.pager.page=n}),e.next=12;break;case 8:if(this.pager.page=n,this.pager.page!==a){e.next=12;break}return e.next=12,this[Nt.onRefresh]();case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"doCommit",value:function(){var e=p()(f.a.mark(function e(){var n,r,o,i,a,l,s,c,u,d,h,p,v;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props.onCommit,r=void 0===n?function(){}:n,o=this.state.executing,i=o.todo,a=void 0===i?null:i,l=o.data,s=void 0===l?null:l,c=null===a,e.next=5,r(c?t.CommitAll:a.ref,c?{modifieds:this.modifieds,removes:[]}:{target:s});case 5:u=e.sent,d=u.success,h=void 0!==d&&d,p=u.msg,v=void 0===p?"":p,c?h?(this.setAlert("已完成資料異動",{type:"success",icon:"fa fa-check-square-o"}),this.doSearch(this.state.filters,this.pager.page)):this.setAlert(v,{type:"danger",icon:"fa fa-exclamation-circle"}):a.onResponse({success:h,msg:v});case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,n,r,o,i,l,s=this,c=this.state,d=c.$GroupSymbol,f=c.sort,h=c.columns,p=this.props.owner,v=this.bgColor,m=this.txColor;return R.a.createElement("div",{className:this[Nt.getContainerClassName]},this[Nt.isModalOpen]?null:R.a.createElement(ft,a()({},this.state.confirm,{onClose:this[Nt.onCloseMessage]})),R.a.createElement(kt,a()({ref:"tbar"},{bgColor:v,txColor:m,manager:this[d]})),R.a.createElement(bt,{bgColor:v,txColor:m,pager:this.pager,onRefresh:this[Nt.onRefresh]}),function(){switch(s.panel){case W.Form:return R.a.createElement(lt,{owner:p,container:s,manager:s[d]},s[Nt.dataviews]);case W.List:return R.a.createElement(Qe,a()({onSorting:s[Nt.onSorting]},{owner:p,sort:f,options:h,container:s,manager:s[d],selectable:s.allselectable}),s[Nt.dataviews]);case W.Card:return R.a.createElement(st,a()({onSorting:s[Nt.onSorting]},{owner:p,sort:f,options:h,container:s,manager:s[d]}),s[Nt.dataviews])}}(),this[Nt.isModalOpen]?null:R.a.createElement(ht,a()({},this.state.alert,{onClose:this[Nt.onCloseMessage]})),(e=this.state.executing,t=e.popup,n=void 0!==t&&t,r=e.todo,o=void 0===r?null:r,i=e.data,l=void 0===i?null:i,null===o||null===l?null:R.a.createElement(gt,a()({ref:"modal",show:n,icon:o.icon,title:o.text},u()({},s[Nt.modalProps],{btns:[{icon:"fa fa-undo",color:"secondary",text:"取消",value:!1},{icon:"fa fa-floppy-o",color:"primary",text:"儲存",value:!0,disabled:function(){return!l.$editable||!l.$isDirty||!l.$isValid}}]})),R.a.createElement(lt,{owner:p,container:s,manager:s[d],selectable:s.allselectable},l.$dataviewOpts))))}},{key:"panel",get:function(){return this.props.panel||W.List}},{key:"bgColor",get:function(){return this.props.toolBgColor||"#007bff"}},{key:"txColor",get:function(){return this.props.toolTxColor||"white"}},{key:"pager",get:function(){return this[this.state.$PagerSymbol]}},{key:"data",get:function(){return Array.isArray(this.state.data)?this.state.data:[]}},{key:"allselectable",get:function(){return this.data.filter(function(e){return e.$selectionOpts.visible}).length>0}},{key:"allselecteds",get:function(){return this.data.filter(function(e){return!0===e.$checked})}},{key:"selecteds",get:function(){return this.data.filter(function(e){return!e.$editable&&!0===e.$checked})}},{key:"editings",get:function(){return this.data.filter(function(e){return e.$editable})}},{key:"executingData",get:function(){return this.state.executing.data}},{key:"executingTodo",get:function(){return this.state.executing.todo}},{key:"modifieds",get:function(){return this.editings.filter(function(e){return e.$checked&&e.$isDirty&&e.$isValid})}},{key:Lt,get:function(){var e=["kekkai-container"];switch(this.panel){case W.Card:e.push("card");break;case W.Form:e.push("form");break;case W.List:e.push("list")}return e.join(" ")}},{key:Tt,get:function(){return this.data.filter(function(e){return!1===e.$hidden&&e.$dataviewOpts&&e.$dataviewOpts.type===at}).map(function(e){return e.$dataviewOpts})}},{key:Rt,get:function(){var e=this.state.executing,t=e.popup,n=void 0!==t&&t,r=e.todo,o=void 0===r?null:r,i=e.data;return n&&null!==o&&null!==(void 0===i?null:i)}},{key:Mt,get:function(){return{closeByMask:!1,alert:this.state.alert,confirm:this.state.confirm,onCloseMessage:this[Nt.onCloseMessage],onTrigger:this[Nt.onModalTrigger],onClose:this[Nt.onCloseModal],bgColor:this.bgColor,txColor:this.txColor}}}]),t}(T.Component);L()(jt,"CommitAll",Symbol("ALL_COMMIT")),n.d(t,"KekkaiContainer",function(){return jt}),n.d(t,"KekkaiDataview",function(){return at}),n.d(t,"KekkaiField",function(){return re}),n.d(t,"KekkaiDisplay",function(){return V}),n.d(t,"KekkaiEditor",function(){return K}),n.d(t,"LayoutOpts",function(){return W}),n.d(t,"TriggerOpts",function(){return ge}),n.d(t,"EditingModeOpts",function(){return ye}),n.d(t,"Todo",function(){return Ce}),n.d(t,"TodoScripts",function(){return Ae});var Gt={react:o.a.resolve("./node_modules/react"),moment:o.a.resolve("./node_modules/moment"),numeral:o.a.resolve("./node_modules/numeral")};t.default=Gt}])});